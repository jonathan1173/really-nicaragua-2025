{% extends 'rally_nicaragua/base.html' %}
{% load breadcrumbs %}
{% load static %}
{% block scripts %}
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script src="{% static 'page/js/favorite.js' %}"></script>
{% comment %} Asegúrate de que este script cargue Lucide si no está en base.html {% endcomment %}
<script>
  document.addEventListener("DOMContentLoaded", function () {
    if (typeof lucide !== 'undefined') {
      lucide.createIcons();
    }
  });
</script>
{% endblock %}
{% block content %}
<!-- Barra de direcciones (minimalista, de la respuesta anterior) -->
{% render_breadcrumb %}

<div class="min-h-screen bg-white text-gray-800">
  <div class="container mx-auto px-4 py-8 max-w-7xl">

    <!-- Sección de Introducción/Hero - Contenido General -->
    <section class="mb-12 text-center">
      <h1 class="text-4xl sm:text-5xl lg:text-6xl font-extrabold text-gray-900 mb-4 leading-tight">
        Descubre la Belleza de
        <span class="text-transparent bg-clip-text bg-gradient-to-r from-blue-600 via-green-600 to-yellow-600">
          {{ department.name }}
        </span>
      </h1>
    </section>

    <!-- Sección de Detalles del Departamento -->
    <section class="bg-white p-8 rounded-lg shadow-lg border border-gray-200 mb-12">
      {% if department %}
      <!-- Título del departamento y botón de favoritos -->
      <div
        class="flex flex-col md:flex-row md:items-center md:justify-between flex-wrap mb-6 pb-4 border-b border-gray-100">
        <div
          class="flex items-center mb-4 md:mb-0 text-center md:text-left w-full md:w-auto justify-center md:justify-start">
          <div class="p-3 rounded-full bg-blue-500 flex items-center justify-center flex-shrink-0 mr-3">
            <i data-lucide="map-pin" class="w-7 h-7 text-white"></i>
          </div>
          <h2 class="text-2xl font-extrabold text-gray-900">
            Departamento: {{ department.name }}
          </h2>
        </div>
        <!-- btn de favoritos -->
        {% if user.is_authenticated %}
        <button id="favorite-btn" data-url="{{ request.path }}" data-title="{{ department.name }}"
          class="inline-flex items-center px-6 py-2 rounded-xl text-white bg-blue-600 hover:bg-blue-700 shadow-md transition-all duration-300 transform hover:scale-105 mx-auto md:mx-0">
          <i data-lucide="heart" class="w-5 h-5 mr-2"></i>
          <span>Agregar a Favoritos</span>
        </button>
        {% endif %}
      </div>

      <!-- descripcion del departamento -->
      {% if department.description %}
      <p class="text-lg text-gray-700 leading-relaxed mb-6 border-b border-gray-100 pb-6">
        {{ department.description }}
      </p>
      {% endif %}

      <!-- municipios del departamento -->
      {% if municipalities %}
      <h3 class="text-2xl font-semibold text-gray-800 mb-4 flex items-center">
        <i data-lucide="building-2" class="w-6 h-6 text-green-600 mr-2"></i>
        Municipios:
      </h3>
      <ul class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        {% for muni in municipalities %}
        <li>
          <a href="{% url 'municipality-detail' municipality_slug=muni.slug %}"
            class="block p-4 rounded-lg bg-gray-50 hover:bg-gray-100 border border-gray-200 text-blue-600 hover:text-blue-800 transition-all duration-200 flex items-center gap-2 transform hover:translate-x-1">
            <i data-lucide="map" class="w-5 h-5 text-blue-500"></i>
            <span class="font-medium">{{ muni.name }}</span>
          </a>
        </li>
        {% endfor %}
      </ul>
      {% else %}
      <p class="text-gray-600 italic">No hay municipios disponibles para este departamento.</p>
      {% endif %}
      {% else %}
      <p class="text-gray-600 italic text-center">No se encontró el departamento solicitado.</p>
      {% endif %}
    </section>

    <!-- Sección de Galería de Imágenes - Contenido General -->
    <section class="mb-12">
      <h3 class="text-3xl font-bold text-gray-900 text-center mb-8">Momentos Inolvidables en Nicaragua</h3>
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
        <div
          class="relative group rounded-lg overflow-hidden shadow-md border border-gray-200 transform hover:scale-[1.02] transition-transform duration-300">
          <img src="{% static 'img/masaya.webp' %}" alt="Volcán de Nicaragua"
            class="w-full h-48 object-cover transition-transform duration-300 group-hover:scale-105" />
          <div
            class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent flex items-end p-4 text-white text-lg font-semibold opacity-0 group-hover:opacity-100 transition-opacity duration-300">
            Impresionante Volcán
          </div>
        </div>
        <div
          class="relative group rounded-lg overflow-hidden shadow-md border border-gray-200 transform hover:scale-[1.02] transition-transform duration-300">
          <img src="{% static 'img/masaya.webp' %}" alt="Calles coloniales"
            class="w-full h-48 object-cover transition-transform duration-300 group-hover:scale-105" />
          <div
            class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent flex items-end p-4 text-white text-lg font-semibold opacity-0 group-hover:opacity-100 transition-opacity duration-300">
            Encanto Colonial
          </div>
        </div>
        <div
          class="relative group rounded-lg overflow-hidden shadow-md border border-gray-200 transform hover:scale-[1.02] transition-transform duration-300">
          <img src="{% static 'img/masaya.webp' %}" alt="Atardecer en el lago"
            class="w-full h-48 object-cover transition-transform duration-300 group-hover:scale-105" />
          <div
            class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent flex items-end p-4 text-white text-lg font-semibold opacity-0 group-hover:opacity-100 transition-opacity duration-300">
            Serenos Atardeceres
          </div>
        </div>
      </div>
    </section>

    <!-- Nueva Sección: Gastronomía Local -->
    <section class="mb-12 bg-white p-8 rounded-lg shadow-lg">
      <h3 class="text-3xl font-bold text-gray-900 text-center mb-8">Sabores Auténticos de Nicaragua</h3>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
        <div>
          <img src="{% static 'img/masaya.webp' %}" alt="Gallo Pinto"
            class="w-full h-64 object-cover rounded-lg shadow-md mb-4" />
          <h4 class="text-2xl font-semibold text-gray-900 mb-2">Gallo Pinto</h4>
          <p class="text-gray-700 mb-4">
            El plato nacional, una deliciosa mezcla de arroz y frijoles, esencial en cada comida nicaragüense.
          </p>
        </div>
        <div>
          <img src="{% static 'img/masaya.webp' %}" alt="Vigorón"
            class="w-full h-64 object-cover rounded-lg shadow-md mb-4" />
          <h4 class="text-2xl font-semibold text-gray-900 mb-2">Vigorón</h4>
          <p class="text-gray-700 mb-4">
            Una explosión de sabor con yuca cocida, chicharrón y ensalada de repollo, ideal para un almuerzo rápido.
          </p>
        </div>
      </div>
      <div class="text-center mt-8">
        <button
          class="bg-yellow-600 hover:bg-yellow-700 text-white px-6 py-2 rounded-xl shadow-md flex items-center justify-center gap-2 mx-auto transition-all duration-300">
          <i data-lucide="chef-hat" class="w-5 h-5 mr-2"></i>
          Descubre Más Platos
        </button>
      </div>
    </section>


    <!-- Sección de Preguntas Frecuentes (FAQ) - Contenido General -->
    <section class="mb-12 max-w-3xl mx-auto">
      <h3 class="text-3xl font-bold text-gray-900 text-center mb-8">Preguntas Frecuentes</h3>
      <div class="space-y-4">
        <div class="border border-gray-200 rounded-lg overflow-hidden shadow-sm">
          <button
            class="flex justify-between items-center w-full p-4 text-left font-semibold text-gray-800 bg-gray-50 hover:bg-gray-100 transition-colors duration-200 focus:outline-none">
            <span>¿Cuál es la mejor época para visitar Nicaragua?</span>
            <i data-lucide="chevron-down" class="w-5 h-5 text-gray-600"></i>
          </button>
          <div class="p-4 text-gray-700 bg-white border-t border-gray-100 hidden">
            La mejor época para visitar Nicaragua es durante la estación seca, de noviembre a abril, cuando el clima es
            soleado y las temperaturas son agradables.
          </div>
        </div>
        <div class="border border-gray-200 rounded-lg overflow-hidden shadow-sm">
          <button
            class="flex justify-between items-center w-full p-4 text-left font-semibold text-gray-800 bg-gray-50 hover:bg-gray-100 transition-colors duration-200 focus:outline-none">
            <span>¿Qué actividades se pueden realizar?</span>
            <i data-lucide="chevron-down" class="w-5 h-5 text-gray-600"></i>
          </button>
          <div class="p-4 text-gray-700 bg-white border-t border-gray-100 hidden">
            Nicaragua ofrece una amplia gama de actividades, desde senderismo en volcanes, surf en el Pacífico,
            exploraciones coloniales en Granada y León, hasta paseos en bote por el Lago de Nicaragua y visitas a
            reservas naturales.
          </div>
        </div>
        <div class="border border-gray-200 rounded-lg overflow-hidden shadow-sm">
          <button
            class="flex justify-between items-center w-full p-4 text-left font-semibold text-gray-800 bg-gray-50 hover:bg-gray-100 transition-colors duration-200 focus:outline-none">
            <span>¿Es seguro viajar por Nicaragua?</span>
            <i data-lucide="chevron-down" class="w-5 h-5 text-gray-600"></i>
          </button>
          <div class="p-4 text-gray-700 bg-white border-t border-gray-100 hidden">
            Como en cualquier destino, es importante tomar precauciones básicas. Generalmente, las zonas turísticas son
            seguras. Se recomienda informarse sobre la situación actual y seguir las recomendaciones de seguridad
            locales.
          </div>
        </div>
      </div>
      <script>
        document.querySelectorAll('section.mb-12.max-w-3xl.mx-auto button').forEach(button => {
          button.addEventListener('click', () => {
            const content = button.nextElementSibling;
            content.classList.toggle('hidden');
            const icon = button.querySelector('i[data-lucide="chevron-down"]');
            if (icon) {
              icon.classList.toggle('rotate-180');
            }
          });
        });
      </script>
    </section>

    <!-- Call to Action Final - Contenido General -->
    <section class="text-center bg-blue-600 p-12 rounded-lg shadow-xl mb-12">
      <h3 class="text-3xl lg:text-4xl font-bold text-white mb-6">¿Listo para tu Aventura Nicaragüense?</h3>
      <p class="text-xl text-blue-100 max-w-2xl mx-auto mb-8">
        Planifica tu viaje y sumérgete en una experiencia cultural única y descubre todo lo que nuestro hermoso país
        tiene para ofrecer.
      </p>
      <a href="{% url 'home-maps' %}"
        class="inline-flex items-center bg-white text-blue-600 hover:bg-gray-100 px-8 py-3 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-105">
        <i data-lucide="plane" class="w-5 h-5 mr-2"></i>
        <span>Planificar mi Viaje</span>
      </a>
    </section>

  </div>
</div>
{% endblock %}